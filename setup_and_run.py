"""
–£–°–¢–ê–ù–û–í–ö–ê –ë–ò–ë–õ–ò–û–¢–ï–ö –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê –ö–†–ò–ü–¢–û–ê–î–û–ü–¶–ò–ò
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ü–ï–†–í–´–ú –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
"""

import subprocess
import sys
import os

def install_libraries():
    """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫"""
    print("üîß –£–°–¢–ê–ù–û–í–ö–ê –ë–ò–ë–õ–ò–û–¢–ï–ö –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê –ö–†–ò–ü–¢–û–ê–î–û–ü–¶–ò–ò")
    print("=" * 50)
    
    # –¢–û–ß–ù–´–ô —Å–ø–∏—Å–æ–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
    libraries = [
    'pandas>=2.0.0',
    'numpy>=1.24.0', 
    'matplotlib>=3.7.0',
    'openpyxl>=3.1.0',
    'plotly>=5.15.0',
    'pyyaml>=6.0' ,
    'jinja2>=3.1.0'  # ‚Üê –î–û–ë–ê–í–ò–¢–¨ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å YAML
] # –¥–ª—è Excel —Ñ–∞–π–ª–æ–≤

    
    print(f"üì¶ –ë—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ {len(libraries)} –±–∏–±–ª–∏–æ—Ç–µ–∫...")
    print("üìã –°–ø–∏—Å–æ–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫:")
    for lib in libraries:
        print(f"   ‚Ä¢ {lib}")
    print()
    
    success = 0
    failed = []
    
    for lib in libraries:
        try:
            print(f"üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ {lib}...")
            subprocess.check_call([sys.executable, "-m", "pip", "install", lib], 
                                stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
            print(f"‚úÖ {lib} —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            success += 1
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ {lib}")
            failed.append(lib)
    
    print(f"\nüìä –†–ï–ó–£–õ–¨–¢–ê–¢: {success}/{len(libraries)} –±–∏–±–ª–∏–æ—Ç–µ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
    
    if success == len(libraries):
        print("üéâ –í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
        print("‚úÖ –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å run.py")
    else:
        print("‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å:")
        for lib in failed:
            print(f"   ‚ùå {lib}")
        print("\nüí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:")
        print("   1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞")
        print("   2. –û–±–Ω–æ–≤–∏—Ç—å pip: python -m pip install --upgrade pip")
    
    input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")

if __name__ == "__main__":
    install_libraries()
